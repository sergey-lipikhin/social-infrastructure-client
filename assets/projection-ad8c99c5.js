import{s as L,dk as M,dl as g,dm as _,dn as E,dp as O,dq as b,cr as N,dr as U,cT as j,cU as k,bE as R,ds as h,dt as V}from"./index-fdfa590d.js";import{e as z}from"./mat3f64-221ce671.js";import{e as W}from"./mat4f64-65d35099.js";import{c as C}from"./spatialReferenceEllipsoidUtils-a35b716b.js";import{i as P,T as i}from"./BufferView-bba8d347.js";import{n as $,s as v}from"./vec32-cc735301.js";const d=L.getLogger("esri.geometry.support.meshUtils.normalProjection");function I(r,e,t,f,o){return l(f)?(F(y.TO_PCPF,P.fromTypedArray(r),i.fromTypedArray(e),i.fromTypedArray(t),f,P.fromTypedArray(o)),o):(d.error("Cannot convert spatial reference to PCPF"),o)}function J(r,e,t,f,o){return l(f)?(F(y.FROM_PCPF,P.fromTypedArray(r),i.fromTypedArray(e),i.fromTypedArray(t),f,P.fromTypedArray(o)),o):(d.error("Cannot convert to spatial reference from PCPF"),o)}function K(r,e,t){return M(r,e,0,t,C(e),0,r.length/3),t}function Q(r,e,t){return M(r,C(t),0,e,t,0,r.length/3),e}function X(r,e,t){return h(n,t),$(e,r,n),V(n)||v(e,e),e}function Z(r,e,t){if(h(n,t),$(e,r,n,4),V(n)||v(e,e,4),r!==e)for(let f=3;f<r.length;f+=4)e[f]=r[f];return e}function rr(r,e,t,f,o){if(!l(f))return d.error("Cannot convert spatial reference to PCPF"),o;F(y.TO_PCPF,P.fromTypedArray(r,4*Float32Array.BYTES_PER_ELEMENT),i.fromTypedArray(e),i.fromTypedArray(t),f,P.fromTypedArray(o,4*Float32Array.BYTES_PER_ELEMENT));for(let a=3;a<r.length;a+=4)o[a]=r[a];return o}function er(r,e,t,f,o){if(!l(f))return d.error("Cannot convert to spatial reference from PCPF"),o;F(y.FROM_PCPF,P.fromTypedArray(r,16),i.fromTypedArray(e),i.fromTypedArray(t),f,P.fromTypedArray(o,16));for(let a=3;a<r.length;a+=4)o[a]=r[a];return o}function F(r,e,t,f,o,a){if(!e)return;const A=t.count,u=C(o);if(S(o))for(let c=0;c<A;c++)f.getVec(c,p),e.getVec(c,s),g(u,p,T,u),_(n,T),r===y.FROM_PCPF&&E(n,n),O(s,s,n),a.setVec(c,s);else for(let c=0;c<A;c++){f.getVec(c,p),e.getVec(c,s),g(u,p,T,u),_(n,T);const B=b(t.get(c,1));let m=Math.cos(B);r===y.TO_PCPF&&(m=1/m),n[0]*=m,n[1]*=m,n[2]*=m,n[3]*=m,n[4]*=m,n[5]*=m,r===y.FROM_PCPF&&E(n,n),O(s,s,n),N(s,s),a.setVec(c,s)}return a}function l(r){return S(r)||Y(r)}function S(r){return r.isWGS84||U(r)||j(r)||k(r)}function Y(r){return r.isWebMercator}var y;(function(r){r[r.TO_PCPF=0]="TO_PCPF",r[r.FROM_PCPF=1]="FROM_PCPF"})(y||(y={}));const p=R(),s=R(),T=W(),n=z();export{Q as E,X as M,Z as O,rr as R,I as _,K as h,J as j,er as v};
