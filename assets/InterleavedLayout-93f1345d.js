import{y as p,u as _,i as y,c as m,l as F,p as w,o as g,m as E,T as b,h as v,a as A,b as $,d as M,A as T,O,x,g as B,w as V,E as D,L as C,B as U,F as G,I as S,U as j,j as k,V as z,M as q,S as J,k as K,q as L,v as N,z as P,C as Q,D as R,G as W,H as X}from"./BufferView-bba8d347.js";import{e as c}from"./types-1305598a.js";import{ca as Y}from"./index-fdfa590d.js";class Z{constructor(e){this.message=e}toString(){return`AssertException: ${this.message}`}}function ee(i,e){if(!i){e=e||"Assertion";const t=new Error(e).stack;throw new Z(`${e} at ${t}`)}}function he(i,e){i||(e=e||"",console.warn("Verify failed: "+e+`
`+new Error("verify").stack))}function ue(i,e,t,r){let s,n=(t[0]-i[0])/e[0],h=(r[0]-i[0])/e[0];n>h&&(s=n,n=h,h=s);let f=(t[1]-i[1])/e[1],u=(r[1]-i[1])/e[1];if(f>u&&(s=f,f=u,u=s),n>u||f>h)return!1;f>n&&(n=f),u<h&&(h=u);let a=(t[2]-i[2])/e[2],d=(r[2]-i[2])/e[2];return a>d&&(s=a,a=d,d=s),!(n>d||a>h)&&(d<h&&(h=d),!(h<0))}function fe(i,e,t,r,s,n=Y()){const h=(r[s]-t[s])*(e[0]-i[0])-(r[0]-t[0])*(e[s]-i[s]),f=(r[0]-t[0])*(i[s]-t[s])-(r[s]-t[s])*(i[0]-t[0]);if(h===0)return!1;const u=f/h;return n[0]=i[0]+u*(e[0]-i[0]),n[1]=i[s]+u*(e[s]-i[s]),!0}function de(i,e){return Math.log(i)/Math.log(e)}function ae(i,e,t,r){i[12]=e,i[13]=t,i[14]=r}function le(i){return i[0]===1&&i[1]===0&&i[2]===0&&i[3]===0&&i[4]===0&&i[5]===1&&i[6]===0&&i[7]===0&&i[8]===0&&i[9]===0&&i[10]===1&&i[11]===0&&i[15]===1}class l{constructor(e,t){this.layout=e,this.buffer=typeof t=="number"?new ArrayBuffer(t*e.stride):t;for(const r of e.fields.keys()){const s=e.fields.get(r);this[r]=new s.constructor(this.buffer,s.offset,this.stride)}}get stride(){return this.layout.stride}get count(){return this.buffer.byteLength/this.stride}get byteLength(){return this.buffer.byteLength}getField(e,t){const r=this[e];return r&&r.elementCount===t.ElementCount&&r.elementType===t.ElementType?r:null}slice(e,t){return new l(this.layout,this.buffer.slice(e*this.stride,t*this.stride))}copyFrom(e,t=0,r=0,s=e.count){const n=this.stride;if(n%4==0){const h=new Uint32Array(e.buffer,t*n,s*n/4);new Uint32Array(this.buffer,r*n,s*n/4).set(h)}else{const h=new Uint8Array(e.buffer,t*n,s*n);new Uint8Array(this.buffer,r*n,s*n).set(h)}return this}}class o{constructor(e=null){this._stride=0,this._lastAligned=0,this._fields=new Map,e&&(this._stride=e.stride,e.fields.forEach(t=>this._fields.set(t[0],{...t[1],constructor:ie(t[1].constructor)})))}vec2f(e,t){return this._appendField(e,_,t),this}vec2f64(e,t){return this._appendField(e,E,t),this}vec3f(e,t){return this._appendField(e,y,t),this}vec3f64(e,t){return this._appendField(e,b,t),this}vec4f(e,t){return this._appendField(e,m,t),this}vec4f64(e,t){return this._appendField(e,v,t),this}mat3f(e,t){return this._appendField(e,F,t),this}mat3f64(e,t){return this._appendField(e,A,t),this}mat4f(e,t){return this._appendField(e,w,t),this}mat4f64(e,t){return this._appendField(e,$,t),this}vec4u8(e,t){return this._appendField(e,x,t),this}f32(e,t){return this._appendField(e,p,t),this}f64(e,t){return this._appendField(e,g,t),this}u8(e,t){return this._appendField(e,M,t),this}u16(e,t){return this._appendField(e,B,t),this}i8(e,t){return this._appendField(e,k,t),this}vec2i8(e,t){return this._appendField(e,z,t),this}vec2i16(e,t){return this._appendField(e,L,t),this}vec2u8(e,t){return this._appendField(e,T,t),this}vec4u16(e,t){return this._appendField(e,C,t),this}u32(e,t){return this._appendField(e,U,t),this}_appendField(e,t,r){if(this._fields.has(e))return void ee(!1,`${e} already added to vertex buffer layout`);const s=t.ElementCount*c(t.ElementType),n=this._stride;this._stride+=s,this._fields.set(e,{size:s,constructor:t,offset:n,optional:r})}createBuffer(e){return new l(this,e)}createView(e){return new l(this,e)}clone(){const e=new o;return e._stride=this._stride,e._fields=new Map,this._fields.forEach((t,r)=>e._fields.set(r,t)),e.BufferType=this.BufferType,e}get stride(){if(this._lastAligned!==this._fields.size){let e=1;this._fields.forEach(t=>e=Math.max(e,c(t.constructor.ElementType))),this._stride=Math.floor((this._stride+e-1)/e)*e,this._lastAligned=this._fields.size}return this._stride}get fields(){return this._fields}}function oe(){return new o}class ce{constructor(e){this.fields=new Array,e.fields.forEach((t,r)=>{const s={...t,constructor:H(t.constructor)};this.fields.push([r,s])}),this.stride=e.stride}}const te=[p,_,y,m,F,w,g,E,b,v,A,$,M,T,O,x,B,V,D,C,U,G,S,j,k,z,q,J,K,L,N,P,Q,R,W,X];function H(i){return`${i.ElementType}_${i.ElementCount}`}function ie(i){return I.get(i)}const I=new Map;te.forEach(i=>I.set(H(i),i));export{o as G,oe as H,ce as I,de as a,he as c,fe as f,ae as h,ue as i,le as l,ee as s};
